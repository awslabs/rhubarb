<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="MCP Server Integration" href="mcp_server.html" /><link rel="prev" title="Video Analysis" href="videoanalysis.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Document Classification - Rhubarb 0.0.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=6eb3cf62" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    <script>
        document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="svg-close" viewBox="0 0 24 24">
            <title>Close Menu</title>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor"
              stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
                <line x1="2" y1="22" x2="22" y2="2"/>
                <line x1="2" y1="2" x2="22" y2="22"/>
            </svg>
        </symbol>
    </svg>
    
    <input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
    <input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
    <label class="overlay sidebar-overlay" for="__navigation">
      <div class="visually-hidden">Hide navigation sidebar</div>
    </label>
    <label class="overlay toc-overlay" for="__toc">
      <div class="visually-hidden">Hide table of contents sidebar</div>
    </label>
    
    
    
    <div class="page">
      <header class="mobile-header">
        <div class="header-left">
          <label class="nav-overlay-icon" id="nav-menu-open" for="__navigation" tabindex="0">
            <div class="visually-hidden">Toggle site navigation sidebar</div>
            <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
          </label>
        </div>
        <div class="header-center">
          <a href="../index.html"><div class="brand">Rhubarb 0.0.7 documentation</div></a>
        </div>
        <div class="header-right">
          <div class="theme-toggle-container theme-toggle-header">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-header-icon" id="toc-menu-open-sm" for="__toc" tabindex="0">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
      </header>
      <aside class="sidebar-drawer">
        <div class="sidebar-container">
          
          <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/Rhubarb@0.5x.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Rhubarb 0.0.7 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-div">
    <p class="sidebar-heading">Feedback</p>
    <p class="sidebar-text">
        Do you have a suggestion to improve this website or Rhubarb?
        <a href="https://github.com/awslabs/rhubarb/issues">Give us feedback</a>.
    </p>
</div><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="usage.html">Usage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="docqa.html">Document Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="specifymodels.html">Change Default Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="useconverseapi.html">Using Converse API</a></li>
<li class="toctree-l2"><a class="reference internal" href="usecrossregioninference.html">Using Cross-Region Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="specifypages.html">Specify Document Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="large_document_processing.html">Large Document Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ner.html">Named Entity Recognition (NER)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pii.html">PII Recognition</a></li>
<li class="toctree-l2"><a class="reference internal" href="keyvalues.html">Structured Data Extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="schemassist.html">Schema Creation Assistant</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">Document Summarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="chatdoc.html">Chat with Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="figures.html">Working with images</a></li>
<li class="toctree-l2"><a class="reference internal" href="videoanalysis.html">Video Analysis</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Document Classification</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mcp_server.html">MCP Server Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="configurations.html">Global Configuration</a></li>
</ul>

</div></div>
          </div>
          
        </div>
      </aside>
      <div class="main">
        <div class="content">
          <div class="article-container">
            <a href="#" class="back-to-top muted-link">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
              </svg>
              <span>Back to top</span>
            </a>
            <div class="content-icon-container">
              
<div class="theme-toggle-container theme-toggle-content">
                <button class="theme-toggle">
                  <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                  <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
                  <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
                  <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
                </button>
              </div>
              <label class="toc-overlay-icon toc-content-icon" id="toc-menu-open-md" for="__toc" tabindex="0">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
              </label>
            </div>
            <article role="main">
              <section id="document-classification">
<h1>Document Classification<a class="headerlink" href="#document-classification" title="Link to this heading">¶</a></h1>
<p>You can perform a more accurate, and cost effective document classification with Rhubarb’s vector sampling functionality. Internally, Rhubarb uses Amazon Titan Multi-modal embedding model for this purpose. Here are the high level steps you will follow to setup a classifier, and then run document classifications with it.</p>
<section id="how-are-the-documents-classified">
<h2>How are the documents classified?<a class="headerlink" href="#how-are-the-documents-classified" title="Link to this heading">¶</a></h2>
<p>The premise of classification based on vector sampling relies on the fact that you have a small set of labeled documents and
their corresponding vectors (embeddings). Given this sample set, you can generate vector embeddings of a new document and
perform similarity check with your sample set to determine which type of document the new document closely resembles to.</p>
<p>For that, Rhubarb offers two methods of choice-</p>
<ol class="arabic simple">
<li><p><strong>Cosine Similarity</strong> (<cite>cosine</cite>) to measure the similarity of a new document’s vector embeddings with the sample set of labeled vectors. Cosine Similarity measures the cosine of the angle between two non-zero vectors in a multi-dimensional space. It’s derived from the dot product of the vectors divided by the product of their magnitudes (norms). For each class, it finds the maximum similarity score among all its vectors compared to the page’s embedding. This score represents how closely the page’s content resembles the content typical of that class. If the highest similarity score across all classes is below a certain threshold (unknown_threshold), it classifies the page as “UNKNOWN”. This means that the page does not closely resemble any of the known classes above the specified confidence level. The UNKNOWN class is assigned the highest similarity score found, even though it’s below the threshold (more on this later).</p></li>
<li><p><strong>Euclidean distance</strong>, also known as L2 distance (<cite>l2</cite>), measures the straight line distance between two points in a multi-dimensional space. It is derived from the square root of the sum of the squared differences between corresponding elements of the two vectors. For each class, the Euclidean distance between the page’s embedding and each of the class’s sample vectors is calculated. Unlike cosine similarity, which measures the angle between vectors, Euclidean distance measures the magnitude of difference between vectors. A smaller Euclidean distance indicates a closer or more similar match between the vectors. Therefore, for each class, you would typically look for the minimum Euclidean distance between the page’s embedding and the class’s vectors to determine the closest match.</p></li>
</ol>
</section>
<section id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>You will need to define a the classes (a.k.a. labels or document class) for the documents.</p></li>
<li><p>Collect a few sample documents for each class (minimum 1 sample max 10 samples each class)</p></li>
<li><p>Create a CSV manifest file</p></li>
<li><p>Run sampling using the manifest file, capture the <code class="code docutils literal notranslate"><span class="pre">sample</span> <span class="pre">ID</span></code> (you will need this to run classification)</p></li>
<li><p>Run classifications with new document using the <code class="code docutils literal notranslate"><span class="pre">sample</span> <span class="pre">ID</span></code> from step 4.</p></li>
</ol>
</section>
<section id="create-a-manifest-file">
<h2>Create a manifest file<a class="headerlink" href="#create-a-manifest-file" title="Link to this heading">¶</a></h2>
<p>Your manifest file should be of CSV format. For example</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>BANK_STATEMENT,s3://your-bucket/samples/bank_stmt_0.pdf,1
BANK_STATEMENT,s3://your-bucket/samples/bank_stmt_1.pdf,1
BANK_STATEMENT,s3://your-bucket/samples/bank_stmt_2.pdf,1
INVOICE,s3://your-bucket/samples/invoice_0.pdf,1
INVOICE,s3://your-bucket/samples/invoice_1.pdf,1
RECEIPT,s3://your-bucket/samples/receipt_0.pdf,1
RECEIPT,s3://your-bucket/samples/receipt_1.pdf,1
RECEIPT,s3://your-bucket/samples/receipt_2.pdf,1
</pre></div>
</div>
<p>The manifest CSV file must contain three fields-</p>
<ol class="arabic simple">
<li><p>The class label should be the first field</p></li>
<li><p>The sample document belonging to that class, either local path or <code class="code docutils literal notranslate"><span class="pre">s3://</span></code> location of the sample document. S3 locations are recommended but local path’s can be used during development.</p></li>
<li><p>Third column is the page number of the document (in case the document is multi-page pdf)</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you would like to include all pages of a multi-page document in the sample dataset then you must make separate lines in the csv with the same document and the subsequent page number.</p>
</div>
<p>You can store this manifest file into an S3 location (recommended) or use it locally. Once you have your manifest file ready we can create a classifier.</p>
</section>
<section id="setup-a-classifier">
<h2>Setup a classifier<a class="headerlink" href="#setup-a-classifier" title="Link to this heading">¶</a></h2>
<p>You initialize an instance of <code class="code docutils literal notranslate"><span class="pre">DocClassification</span></code> and call the <code class="code docutils literal notranslate"><span class="pre">run_sampling()</span></code> function with the manifest file path to start the sampling process. This should be a fairly quick process and shouldn’t take more than a few minutes.
The function will return a <code class="code docutils literal notranslate"><span class="pre">sample_id</span></code> which you can subsequently use to run document classification tasks. You will also need to provide an S3 bucket where the resulting vector samples will be stored for later use.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_sampling</span><span class="p">(</span><span class="n">manifest_path</span><span class="o">=</span><span class="s2">&quot;s3://your-bucket/manifest.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;sample_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rb_classifier_1711608335&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Creating a classifier (sample) is a one-time process, i.e. once you setup your classifier you can use the <cite>sample_id</cite> to perform document classification tasks.</p>
</section>
<section id="using-a-classifier">
<h2>Using a classifier<a class="headerlink" href="#using-a-classifier" title="Link to this heading">¶</a></h2>
<p>You use the <code class="code docutils literal notranslate"><span class="pre">run_classify()</span></code> function with path to the new document you would like to classify. The file can be a multi-page document and Rhubarb will classify each page individually.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_classify</span><span class="p">(</span><span class="n">sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">,</span>
                          <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;./test_docs/bank_stmt.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BANK_STATEMENT&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.92</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<section id="using-unknown-threshold">
<h3>Using <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code><a class="headerlink" href="#using-unknown-threshold" title="Link to this heading">¶</a></h3>
<p>In some cases, your document processing pipeline may encounter documents that do not belong to any of the pre-configured classes.
In such cases, it can be useful to mark these documents as <code class="code docutils literal notranslate"><span class="pre">UNKNOWN</span></code> and isolate them for further analysis. This can be achieved
using the <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code> parameter. By default, the value is set to <code class="code docutils literal notranslate"><span class="pre">0.8</span></code> i.e. any document below this threshold is
automatically marked as <code class="code docutils literal notranslate"><span class="pre">UNKNOWN</span></code>. However, you can override this value to further tune your classification task.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
 <span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

 <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
 <span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
 <span class="n">results</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_classify</span><span class="p">(</span><span class="n">sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">,</span>
                         <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;./test_docs/Sample1.pdf&quot;</span><span class="p">,</span>
<span class="hll">                         <span class="n">top_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span class="hll">                         <span class="n">unknown_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</span> <span class="n">results</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BANK_STATEMENT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.93</span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DISCHARGE_SUMMARY&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.76</span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RECEIPT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">},</span>
<span class="w">            </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVOICE&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.78</span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6150004682895025</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.7916701829486292</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8255265125891919</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.768307452125929</span><span class="p">}]}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The score for <code class="code docutils literal notranslate"><span class="pre">UNKNOWN</span></code> classification is the highest similarity score (even if it’s below the threshold). This gives a sense of
how close the document was to being classified into one of the known classes before being deemed unknown. To view what the unknown
pages is actually getting classified into, you can reduce the <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code> and re-run the classification. Ideally, you
would experiment and tune this score based on your use cases, the number of samples you used while creating the classifier, the
number of classes, and the different type of documents you receive for your use-case.</p>
</section>
<section id="using-similarity-metric">
<h3>Using <code class="code docutils literal notranslate"><span class="pre">similarity_metric</span></code><a class="headerlink" href="#using-similarity-metric" title="Link to this heading">¶</a></h3>
<p>By default Rhubarb uses <em>Cosine similarity</em> to determine the class of a given page. If default Cosine similarity is used then
scores can be between 0 and 1, and the higher the score the better. Higher number means the given document is most similar to
the samples in the given class.</p>
<p>However, you can also choose <em>Euclidian distance</em> similarity metric (a.k.a L2 distance). In this case, scores will range beween
0 and 1, and the lower the number, the better, which means the straight line distance between the vector of the give document
and the vector’s of the class it is categorized in is the least. You can set the <code class="code docutils literal notranslate"><span class="pre">similarity_metric</span></code> to <code class="code docutils literal notranslate"><span class="pre">l2</span></code> to force using
Euclidian distance for classification.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of Euclidian distance, your <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code> is the inverse of <code class="code docutils literal notranslate"><span class="pre">cosine</span></code> similarity. Which means if <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code> is set to <code class="code docutils literal notranslate"><span class="pre">0.5</span></code> then any class with score more than <code class="code docutils literal notranslate"><span class="pre">0.5</span></code> will be marked as <code class="code docutils literal notranslate"><span class="pre">UNKNOWN</span></code> since it is the most dissimilar to all the known classes.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_classify</span><span class="p">(</span><span class="n">sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">,</span>
                          <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;./test_docs/Sample1.pdf&quot;</span><span class="p">,</span>
<span class="hll">                          <span class="n">similarity_metric</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span>
</span><span class="hll">                          <span class="n">unknown_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># threshold is low because smaller is better</span>
</span></pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BANK_STATEMENT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.38</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RECEIPT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.87749589194715</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6454917724396393</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5907173241851739</span><span class="p">}]},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;page&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;classification&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6807239544254996</span><span class="p">}]}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="viewing-a-classifier">
<h2>Viewing a classifier<a class="headerlink" href="#viewing-a-classifier" title="Link to this heading">¶</a></h2>
<p>You can view the details of an existing classifier using the <code class="code docutils literal notranslate"><span class="pre">view_sample()</span></code> function. This will show you the classes you
have configured for your classifiers and the samples you used while creating the classifier.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="hll"><span class="n">dc</span><span class="o">.</span><span class="n">view_sample</span><span class="p">(</span><span class="n">sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BANK_STATEMENT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVOICE&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RECEIPT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="updating-a-classifier">
<h2>Updating a classifier<a class="headerlink" href="#updating-a-classifier" title="Link to this heading">¶</a></h2>
<p>You may have a need to subsequently update your classifier to add new classes, or samples. You can easily do that just like
creating a new classifier with the help of a new manifest CSV file. But this time, you will need to supply an existing
<code class="code docutils literal notranslate"><span class="pre">sample_id</span></code> to the <code class="code docutils literal notranslate"><span class="pre">run_sampling()</span></code> function via the <code class="code docutils literal notranslate"><span class="pre">update_sample_id</span></code> parameter. This will process the
manifest file but instead of creating a new classifier, will update the existing classifier (sample). For example with our new
<code class="code docutils literal notranslate"><span class="pre">manifest2.csv</span></code> we would like to update our existing sample.</p>
<p><code class="code docutils literal notranslate"><span class="pre">manifest2.csv</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>DISCHARGE_SUMMARY,s3://your-bucket/samples/discharge_summary_0.pdf,1
DISCHARGE_SUMMARY,s3://your-bucket/samples/discharge_summary_1.pdf,1
DISCHARGE_SUMMARY,s3://your-bucket/samples/discharge_summary_2.pdf,1
DISCHARGE_SUMMARY,s3://your-bucket/samples/discharge_summary_3.pdf,1
DISCHARGE_SUMMARY,s3://your-bucket/samples/discharge_summary_4.pdf,1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that you use samples that were not used before while creating the classifier (sample), since Rhubarb doesn’t do any de-duplication internally.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
 <span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

 <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
 <span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span>
                        <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
 <span class="n">classifier</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_sampling</span><span class="p">(</span><span class="n">manifest_path</span><span class="o">=</span><span class="s2">&quot;s3://your-bucket/manifest2.csv&quot;</span><span class="p">,</span>
<span class="hll">                              <span class="n">update_sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;sample_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rb_classifier_1711608335&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>View the updated classifier</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="n">dc</span><span class="o">.</span><span class="n">view_sample</span><span class="p">(</span><span class="n">sample_id</span><span class="o">=</span><span class="s2">&quot;rb_classifier_1711608335&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BANK_STATEMENT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVOICE&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RECEIPT&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="nt">&quot;class&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DISCHARGE_SUMMARY&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;num_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="how-is-the-classifier-stored">
<h2>How is the classifier stored?<a class="headerlink" href="#how-is-the-classifier-stored" title="Link to this heading">¶</a></h2>
<p>Your classifier will contain three distinct parts</p>
<ol class="arabic simple">
<li><p>A unique identifier (<code class="code docutils literal notranslate"><span class="pre">sample_id</span></code>)</p></li>
<li><p>The class labels (i.e. <code class="code docutils literal notranslate"><span class="pre">BANK_STATEMENT</span></code>, <code class="code docutils literal notranslate"><span class="pre">RECEIPTS</span></code> and so on)</p></li>
<li><p>The multi-modal vector embeddings for each of the sample document for each class as specified in the manifest file.</p></li>
</ol>
<p>All of this data is arranged and stored in a compressed Parquet file in the S3 bucket you provide (via the <code class="code docutils literal notranslate"><span class="pre">bucket_name</span></code>
parameter). Within the bucket, Rhubarb will store all your classifiers under the prefix <code class="code docutils literal notranslate"><span class="pre">rb_classification</span></code> by default.
However, you can override this prefix via Rhubarb’s <code class="code docutils literal notranslate"><span class="pre">GlobalConfig</span></code> and overriding <code class="code docutils literal notranslate"><span class="pre">classification_prefix</span></code> config
using the <code class="code docutils literal notranslate"><span class="pre">update_config()</span></code> function, with your desired prefix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference external" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-prefixes.html">Organizing S3 objects using prefixes</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The prefix must not contain any leading or trailing <code class="code docutils literal notranslate"><span class="pre">/</span></code>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="kn">from</span><span class="w"> </span><span class="nn">rhubarb</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocClassification</span><span class="p">,</span> <span class="n">GlobalConfig</span>
   <span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>

   <span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="hll">   <span class="n">GlobalConfig</span><span class="o">.</span><span class="n">update_config</span><span class="p">(</span><span class="n">classification_prefix</span><span class="o">=</span><span class="s2">&quot;my_classifiers&quot;</span><span class="p">)</span>
</span>   <span class="n">dc</span> <span class="o">=</span> <span class="n">DocClassification</span><span class="p">(</span><span class="n">bucket_name</span><span class="o">=</span><span class="s2">&quot;your-classifier-bucket&quot;</span><span class="p">,</span> <span class="n">boto3_session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
   <span class="n">classifier</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">run_sampling</span><span class="p">(</span><span class="n">manifest_path</span><span class="o">=</span><span class="s2">&quot;s3://your-bucket/manifest.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

            </article>
          </div>
          <footer>
            
            <div class="related-pages">
              <a class="next-page" href="mcp_server.html">
                  <div class="page-info">
                    <div class="context">
                      <span>Next</span>
                    </div>
                    <div class="title">MCP Server Integration</div>
                  </div>
                  <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
                </a>
              <a class="prev-page" href="videoanalysis.html">
                  <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
                  <div class="page-info">
                    <div class="context">
                      <span>Previous</span>
                    </div>
                    
                    <div class="title">Video Analysis</div>
                    
                  </div>
                </a>
            </div>
            <div class="bottom-of-page">
              <div class="left-details">
                <div class="copyright">
                    Copyright &#169; 2025, Amazon Web Services, Inc
                </div>
                Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
                
                <a href="https://github.com/pradyunsg/furo">Furo</a>
                
                
                <div class="legal-info">
                    <script type="text/javascript" src="../_static/shortbreadv1.js"></script>
                    <script type="text/javascript">
                            const shortbread = AWSCShortbread({
                                domain: ".amazonaws.com",
                });
                            shortbread.checkForCookieConsent();
                    </script>
                    <a href="https://aws.amazon.com/privacy">Privacy</a> | <a href="https://aws.amazon.com/terms">Site Terms</a> | <a
                        href="#" onclick="shortbread.customizeCookies();">Cookie preferences</a>
                </div>
                
              </div>
              <div class="right-details">
                <div class="icons">
                  <a class="muted-link " href="https://github.com/awslabs/rhubarb" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
                  
                </div>
              </div>
            </div>
            
          </footer>
        </div>
        <aside class="toc-drawer">
          
          
          <div class="toc-sticky toc-scroll">
            <div class="sidebar-div show-div-md justify-content-left">
                <label class="nav-close-icon" id="toc-menu-close" for="__toc" tabindex="0">
                    <div class="visually-hidden">Toggle site table of content right sidebar</div>
                    <i class="icon"><svg><use href="#svg-close"></use></svg></i>
                </label>
            </div>
            <div class="toc-title-container">
              <span class="toc-title">
                On this page
              </span>
            </div>
            <div class="toc-tree-container">
              <div class="toc-tree">
                <ul>
<li><a class="reference internal" href="#">Document Classification</a><ul>
<li><a class="reference internal" href="#how-are-the-documents-classified">How are the documents classified?</a></li>
<li><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li><a class="reference internal" href="#create-a-manifest-file">Create a manifest file</a></li>
<li><a class="reference internal" href="#setup-a-classifier">Setup a classifier</a></li>
<li><a class="reference internal" href="#using-a-classifier">Using a classifier</a><ul>
<li><a class="reference internal" href="#using-unknown-threshold">Using <code class="code docutils literal notranslate"><span class="pre">unknown_threshold</span></code></a></li>
<li><a class="reference internal" href="#using-similarity-metric">Using <code class="code docutils literal notranslate"><span class="pre">similarity_metric</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#viewing-a-classifier">Viewing a classifier</a></li>
<li><a class="reference internal" href="#updating-a-classifier">Updating a classifier</a></li>
<li><a class="reference internal" href="#how-is-the-classifier-stored">How is the classifier stored?</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </div>
          
          
        </aside>
      </div>
    </div><script src="../_static/documentation_options.js?v=bbaf98b3"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>